<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- ICONO -->
    <title>WhatsApp Directo</title>
    <link rel="apple-touch-icon" sizes="180x180" href="https://ik.imagekit.io/tnzquipyu/image.ico?updatedAt=1743559795914">
    <link rel="icon" type="image/png" sizes="192x192" href="https://ik.imagekit.io/tnzquipyu/image.ico?updatedAt=1743559795914">
    <meta name="theme-color" content="#25D366">
    <!-- ESTILOS (se mantienen igual) -->
    <style>
        body { font-family: sans-serif; margin: 0; }
        #login-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #25D366; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 1000;
            color: white; text-align: center;
        }
        /* ... (otros estilos se mantienen igual) ... */
    </style>
</head>
<body>
    <!-- Pantalla de login (se mantiene igual) -->
    <div id="login-screen">
        <div id="login-form">
            <h2>ðŸ”’ Acceso Privado</h2>
            <p>Ingresa tu clave personal</p>
            <input type="password" id="password" placeholder="Clave" autocomplete="current-password">
            <button id="unlock-btn">Desbloquear</button>
            <p id="error-msg">Clave incorrecta. Intenta de nuevo.</p>
        </div>
    </div>

    <!-- Contenido de la app (se mantiene igual) -->
    <div id="app-content" class="hidden">
        <h1>WhatsApp Directo</h1>
        <input type="tel" id="phoneNumber" placeholder="Ej: 099123456">
        <button id="sendButton">Abrir Chat</button>
        <p class="info-text">Ingresa nÃºmero (ej: 099123456 o 9123456)</p>
    </div>

    <script>
        // ConfiguraciÃ³n
        const CLAVE_CORRECTA = "1235";
        const CODIGO_PAIS = "598"; // Uruguay
        const DIGITOS_URUGUAY = 8;

        // Elementos DOM
        const loginScreen = document.getElementById('login-screen');
        const appContent = document.getElementById('app-content');
        const passwordInput = document.getElementById('password');
        const unlockBtn = document.getElementById('unlock-btn');
        const errorMsg = document.getElementById('error-msg');
        const phoneInput = document.getElementById('phoneNumber');
        const sendBtn = document.getElementById('sendButton');

        // FunciÃ³n para procesar nÃºmeros uruguayos (se mantiene igual)
        function procesarNumeroUruguayo(numero) {
            let phone = numero.replace(/[^0-9]/g, '');
            if (phone.startsWith('0')) phone = phone.substring(1);
            if (phone.length !== DIGITOS_URUGUAY) {
                alert(`NÃºmero invÃ¡lido. Debe tener ${DIGITOS_URUGUAY} dÃ­gitos. Ejemplo: 099123456 â†’ 99123456`);
                return null;
            }
            return CODIGO_PAIS + phone;
        }

        // ----- CAMBIOS PRINCIPALES (INICIO) -----
        // 1. FunciÃ³n simplificada para verificar autenticaciÃ³n (solo cookie)
        function checkAuth() {
            if (document.cookie.includes("appAuth=true")) {
                loginScreen.classList.add('hidden');
                appContent.classList.remove('hidden');
            }
        }

        // 2. ModificaciÃ³n en handleLogin (cookie permanente y sin hash)
        function handleLogin() {
            errorMsg.style.display = 'none';
            if (passwordInput.value === CLAVE_CORRECTA) {
                try {
                    document.cookie = "appAuth=true; max-age=315360000; path=/; SameSite=Lax"; // 10 aÃ±os
                    loginScreen.classList.add('hidden');
                    appContent.classList.remove('hidden');
                } catch (error) {
                    console.error("Error:", error);
                    alert("Error al desbloquear la aplicaciÃ³n.");
                }
            } else {
                errorMsg.style.display = 'block';
                passwordInput.focus();
            }
        }
        // ----- CAMBIOS PRINCIPALES (FIN) -----

        // Evento para abrir WhatsApp (se mantiene igual)
        sendBtn.addEventListener('click', () => {
            const numero = phoneInput.value.trim();
            if (!numero) {
                alert("Ingresa un nÃºmero de telÃ©fono (ej: 099123456)");
                return;
            }
            const numeroFinal = procesarNumeroUruguayo(numero);
            if (numeroFinal) window.open(`https://wa.me/${numeroFinal}`, '_blank');
        });

        // Eventos para el login (se mantienen igual)
        unlockBtn.addEventListener('click', handleLogin);
        passwordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleLogin();
        });

        // InicializaciÃ³n
        checkAuth();
    </script>
</body>
</html>